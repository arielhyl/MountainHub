<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MountainHub Taiwan</title>
    <style>
        :root {
            --bg: #ffffff;
            --text: #1a1a1a;
            --secondary: #717171;
            --accent: #f5f5f5;
            --border: #eeeeee;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            margin: 0; background: var(--bg); color: var(--text); 
            overflow-x: hidden;
        }

        .app-container { max-width: 500px; margin: 0 auto; min-height: 100vh; display: flex; flex-direction: column; }
        .page { flex: 1; padding: 30px 20px 120px 20px; display: none; }
        .page.active { display: block; }

        /* Header with minimalist icons */
        .header-wrap { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 24px; }
        .backup-icons { display: flex; gap: 15px; padding-top: 5px; }
        .icon-btn { cursor: pointer; color: var(--secondary); transition: color 0.2s; }
        .icon-btn:hover { color: var(--text); }

        h1 { font-size: 20px; font-weight: 600; text-transform: uppercase; margin: 0; letter-spacing: 1px; }
        h2 { font-size: 14px; color: var(--text); margin: 20px 0 10px 0; font-weight: 600; border-left: 3px solid #000; padding-left: 8px; }

        nav {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 0.5px solid var(--border);
            display: flex; justify-content: space-around;
            padding: 12px 0 34px 0;
            z-index: 100;
        }
        .nav-item { cursor: pointer; text-align: center; color: var(--secondary); transition: 0.2s; flex: 1; }
        .nav-item.active { color: var(--text); font-weight: bold; }
        .nav-icon { font-size: 20px; margin-bottom: 4px; display: block; }
        .nav-text { font-size: 10px; text-transform: uppercase; }

        .stats-hero { padding: 40px 0; text-align: center; cursor: pointer; }
        .progress-circle-text { font-size: 48px; font-weight: 200; margin: 0; }
        .progress-bar-bg { width: 100%; height: 2px; background: var(--accent); margin-top: 15px; position: relative; }
        .progress-bar-fill { height: 100%; background: #000; width: 0%; transition: width 0.8s ease; }
        
        .search-box { margin-bottom: 20px; }
        .search-box input { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 0; font-size: 14px; }

        .peak-item { border-bottom: 0.5px solid var(--border); padding: 15px 0; cursor: pointer; }
        .peak-main { display: flex; justify-content: space-between; align-items: center; }
        .peak-title { font-size: 15px; }
        .peak-meta { font-size: 11px; color: var(--secondary); }
        .peak-details { display: none; padding: 15px 0; font-size: 13px; color: var(--secondary); line-height: 1.8; }
        .peak-details.open { display: block; }

        .btn-done { background: #000; color: #fff; border: none; padding: 12px; font-size: 12px; margin-top: 10px; cursor: pointer; width: 100%; }
        .btn-done.is-completed { background: var(--accent); color: var(--secondary); }

        .input-group { display: flex; flex-direction: column; gap: 8px; margin-bottom: 24px; }
        .input-group input, .input-group select { border: 1px solid var(--border); padding: 12px; font-size: 14px; border-radius: 0; width: 100%; -webkit-appearance: none; }
        .input-group button { background: #000; color: #fff; border: none; padding: 14px; font-size: 13px; cursor: pointer; }

        .weight-card { background: #000; color: #fff; padding: 30px; text-align: center; margin-bottom: 24px; }
        .weight-card small { font-size: 10px; opacity: 0.6; display: block; margin-bottom: 8px; }
        .weight-card span { font-size: 42px; font-weight: 200; }

        .list-row { display: flex; align-items: flex-start; justify-content: space-between; padding: 16px 0; border-bottom: 0.5px solid var(--border); font-size: 14px; }
        .log-date { font-size: 11px; color: var(--secondary); margin-bottom: 6px; }

        .modal { display: none; position: fixed; inset: 0; background: rgba(255,255,255,0.98); z-index: 200; padding: 40px 20px; overflow-y: auto; }
        .modal.active { display: block; }
        .close-modal { position: absolute; top: 20px; right: 20px; font-size: 30px; cursor: pointer; color: var(--secondary); }
    </style>
</head>
<body>

<div class="app-container">
    <!-- Home Page -->
    <section id="page-home" class="page active">
        <div class="header-wrap">
            <h1>MountainHub</h1>
            <div class="backup-icons">
                <!-- Export Icon -->
                <div class="icon-btn" onclick="exportData()" title="ÂåØÂá∫Ë≥áÊñô">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                </div>
                <!-- Import Icon -->
                <label class="icon-btn" title="ÂåØÂÖ•Ë≥áÊñô">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                    <input type="file" id="import-file" style="display:none" onchange="importData(event)">
                </label>
            </div>
        </div>
        
        <div class="stats-hero" onclick="showCompletedList()">
            <p class="progress-circle-text" id="total-done-count">0</p>
            <p style="font-size: 12px; color: var(--secondary); margin-top: -5px; letter-spacing: 1px;">COMPLETED PEAKS / 100</p>
            <div class="progress-bar-bg"><div class="progress-bar-fill" id="main-progress-bar"></div></div>
            <p style="font-size: 10px; color: var(--secondary); margin-top: 15px;">ÈªûÊìäÊü•ÁúãÂÆåÁôªÁ¥ÄÈåÑ</p>
        </div>
    </section>

    <!-- Peaks Page -->
    <section id="page-peaks" class="page">
        <h1>Peaks List</h1>
        <div class="search-box">
            <input type="text" id="peak-search" placeholder="ÊêúÂ∞ãÂ±±Âêç„ÄÅÂ±±Á≥ªÊàñÁ≠âÁ¥ö..." oninput="renderPeaks()">
        </div>
        <div id="peaks-container"></div>
    </section>

    <!-- Gear Page -->
    <section id="page-gear" class="page">
        <h1>Lightpack</h1>
        <div class="weight-card">
            <small>BASE WEIGHT (KG)</small>
            <span id="base-weight-display">0.00</span>
        </div>
        <div class="input-group">
            <select id="gear-category">
                <option value="ÁÇäÂÖ∑Á≥ªÁµ±">ÁÇäÂÖ∑Á≥ªÁµ±</option>
                <option value="ÈõªÂ≠êÁ≥ªÁµ±">ÈõªÂ≠êÁ≥ªÁµ±</option>
                <option value="ËÉåË≤†Á≥ªÁµ±">ËÉåË≤†Á≥ªÁµ±</option>
                <option value="Áù°Áú†Á≥ªÁµ±">Áù°Áú†Á≥ªÁµ±</option>
                <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
            </select>
            <input type="text" id="gear-name" placeholder="ÂìÅÂêç">
            <input type="number" id="gear-weight" placeholder="ÈáçÈáè (g)">
            <button onclick="addGear()">ADD TO INVENTORY</button>
        </div>
        <div id="gear-container"></div>
    </section>

    <!-- Training Page -->
    <section id="page-training" class="page">
        <h1>Training Log</h1>
        <div class="input-group">
            <input type="date" id="train-date">
            <input type="text" id="train-desc" placeholder="Ë®ìÁ∑¥È†ÖÁõÆËàáÂøÉÂæóÁ¥ÄÈåÑ">
            <button onclick="addTrain()">ADD ENTRY</button>
        </div>
        <div id="training-container"></div>
    </section>
</div>

<nav>
    <div class="nav-item active" onclick="navTo('home')"><span class="nav-icon">‚óã</span><span class="nav-text">Home</span></div>
    <div class="nav-item" onclick="navTo('peaks')"><span class="nav-icon">‚ñ≥</span><span class="nav-text">Peaks</span></div>
    <div class="nav-item" onclick="navTo('gear')"><span class="nav-icon">‚ñ°</span><span class="nav-text">Gear</span></div>
    <div class="nav-item" onclick="navTo('training')"><span class="nav-icon">‚óá</span><span class="nav-text">Train</span></div>
</nav>

<div id="modal-completed" class="modal">
    <div class="close-modal" onclick="closeModal()">√ó</div>
    <h1>ÂÆåÁôªÊ∏ÖÂñÆ</h1>
    <div id="completed-list-content"></div>
</div>

<script>
    // Ë≥áÊñôÂÆöÁæ©
    const PEAKS_DATA = [
        {id:1, name:"ÁéâÂ±±‰∏ªÂ≥∞", height:3952, grade:"A", range:"ÁéâÂ±±", hut:"ÊéíÈõ≤Â±±Ëéä", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©ËΩâÊé•ÈßÅ"},
        {id:2, name:"Èõ™Â±±‰∏ªÂ≥∞", height:3886, grade:"A", range:"Èõ™Â±±", hut:"‰∏âÂÖ≠‰πùÂ±±Ëéä", permit:"ÂÖ•Âúí", transport:"Ê≠¶ÈôµËæ≤Â†¥"},
        {id:3, name:"ÁßÄÂßëÂ∑íÂ±±", height:3825, grade:"B", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"ÁôΩÊ¥ãÈáëÁ§¶", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:4, name:"È¶¨ÂçöÊãâÊñØÂ±±", height:3785, grade:"C", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"È¶¨ÂâçÊ±†", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:5, name:"ÂçóÊπñÂ§ßÂ±±", height:3742, grade:"B", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"ÂçóÊπñÂ±±Â±ã", permit:"ÂÖ•Âúí", transport:"ÊÄùÊ∫ê"},
        {id:6, name:"Êù±Â±±", height:3704, grade:"B", range:"ÁéâÂ±±", hut:"ÊéíÈõ≤Â±±Ëéä", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©"},
        {id:7, name:"‰∏≠Â§ÆÂ∞ñÂ±±", height:3703, grade:"C", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"‰∏≠Â§ÆÂ∞ñÊ∫™Êú®Â±ã", permit:"ÂÖ•Âúí", transport:"ÊÄùÊ∫ê"},
        {id:8, name:"Èõ™Â±±ÂåóÂ≥∞", height:3703, grade:"B", range:"Èõ™Â±±", hut:"Èõ™ÂåóÂ±±Â±ã", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:9, name:"Â§ßÈóúÂ±±", height:3668, grade:"A", range:"ÂçóÊ©´", hut:"Â∫´ÂìàË´æÊñØÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÂçóÊ©´"},
        {id:10, name:"È¶¨Âà©Âä†ÂçóÂ±±", height:3546, grade:"C", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"È¶¨Âà©Âä†ÂçóÂ±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:11, name:"ÂçóÊπñÂåóÂ±±", height:3536, grade:"B", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"ÂçóÊπñÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÊÄùÊ∫ê"},
        {id:12, name:"Â§ßÈú∏Â∞ñÂ±±", height:3492, grade:"B", range:"Èõ™Â±±", hut:"‰πù‰πùÂ±±Ëéä", permit:"ÂÖ•Âúí", transport:"ËßÄÈúß"},
        {id:13, name:"ÂçóÈ†≠Â±±", height:3449, grade:"C", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"ÂçóÊπñÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÊÄùÊ∫ê"},
        {id:14, name:"ÂìÅÁî∞Â±±", height:3524, grade:"B", range:"Ê≠¶Èôµ‰∏âÂ∞ñ", hut:"Êñ∞ÈÅîÂ±±Â±ã", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:15, name:"Â§ßÈõ™Â±±", height:3530, grade:"C", range:"Èõ™Â±±", hut:"Áø†Ê±†Â±±Â±ã", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:16, name:"Â•áËêä‰∏ªÂ≥∞", height:3560, grade:"B", range:"Â•áËêä", hut:"Â•áËêäÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÂêàÊ≠°"},
        {id:17, name:"Â•áËêäÂåóÂ≥∞", height:3607, grade:"B", range:"Â•áËêä", hut:"Â•áËêäÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÂêàÊ≠°"},
        {id:18, name:"ÂêëÈôΩÂ±±", height:3602, grade:"A", range:"Âçó‰∫åÊÆµ", hut:"ÂòâÊòéÊπñÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÂêëÈôΩ"},
        {id:19, name:"Â§ßÊ∞¥Á™üÂ±±", height:3642, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"Â§ßÊ∞¥Á™üÂ±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:20, name:"ÂêàÊ≠°ÂåóÂ≥∞", height:3422, grade:"A", range:"ÂêàÊ≠°", hut:"ÁÑ°(ÂñÆÊîª)", permit:"ÂÖç", transport:"Âè∞14Áî≤"},
        {id:21, name:"ÂêàÊ≠°‰∏ªÂ≥∞", height:3417, grade:"A", range:"ÂêàÊ≠°", hut:"ÁÑ°(ÂñÆÊîª)", permit:"ÂÖç", transport:"Âè∞14Áî≤"},
        {id:22, name:"ÂêàÊ≠°Êù±Â≥∞", height:3421, grade:"A", range:"ÂêàÊ≠°", hut:"ÁÑ°(ÂñÆÊîª)", permit:"ÂÖç", transport:"Âè∞14Áî≤"},
        {id:23, name:"Áü≥ÈñÄÂ±±", height:3237, grade:"A", range:"ÂêàÊ≠°", hut:"ÁÑ°(ÂñÆÊîª)", permit:"ÂÖç", transport:"Âè∞14Áî≤"},
        {id:24, name:"ÂêàÊ≠°Ë•øÂ≥∞", height:3145, grade:"B", range:"ÂêàÊ≠°", hut:"ÁÑ°(ÂñÆÊîª)", permit:"ÂÖç", transport:"Âè∞14Áî≤"},
        {id:25, name:"ÂåóÂ§ßÊ≠¶Â±±", height:3092, grade:"B", range:"ÂçóÁ´Ø", hut:"Ê™úË∞∑Â±±Ëéä", permit:"ÂÖ•Â±±", transport:"Ê≥∞Ê≠¶"},
        {id:26, name:"ÁÅ´Áü≥Â±±", height:3310, grade:"C", range:"Èõ™Â±±", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:27, name:"È†≠È∑πÂ±±", height:3510, grade:"C", range:"Èõ™Â±±", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:28, name:"Âøó‰Ω≥ÈôΩÂ§ßÂ±±", height:3345, grade:"A", range:"Èõ™Â±±", hut:"Áì¢ÂñÆÂ±±Â±ã", permit:"ÂÖ•Âúí", transport:"Áí∞Â±±"},
        {id:29, name:"Â∞èÈú∏Â∞ñÂ±±", height:3411, grade:"B", range:"Èõ™Â±±", hut:"‰πù‰πùÂ±±Ëéä", permit:"ÂÖ•Âúí", transport:"ËßÄÈúß"},
        {id:30, name:"Âä†Âà©Â±±", height:3112, grade:"A", range:"Èõ™Â±±", hut:"‰πù‰πùÂ±±Ëéä", permit:"ÂÖ•Âúí", transport:"ËßÄÈúß"},
        {id:31, name:"‰ºäÊæ§Â±±", height:3297, grade:"A", range:"Èõ™Â±±", hut:"‰πù‰πùÂ±±Ëéä", permit:"ÂÖ•Âúí", transport:"ËßÄÈúß"},
        {id:32, name:"ÂçëÂçó‰∏ªÂ±±", height:3295, grade:"C", range:"Âçó‰∏ÄÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëó§Êûù"},
        {id:33, name:"Â§™È≠ØÈñ£Â§ßÂ±±", height:3283, grade:"C", range:"Â•áËêäÊù±Á®ú", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"ÂêàÊ≠°"},
        {id:34, name:"‰∏πÂ§ßÂ±±", height:3325, grade:"C", range:"‰∏πÂ§ß", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÁëûÁ©ó"},
        {id:35, name:"ÂÖßÂ∂∫ÁàæÂ±±", height:3275, grade:"C", range:"‰∏πÂ§ß", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÁëûÁ©ó"},
        {id:36, name:"Áæ©Ë•øË´ãÈ¶¨Ëá≥Â±±", height:3245, grade:"C", range:"‰∏πÂ§ß", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÁëûÁ©ó"},
        {id:37, name:"Â±èÈ¢®Â±±", height:3250, grade:"B", range:"Â•áËêä", hut:"Â±èÈ¢®Â±±Â±ã", permit:"ÂÖç", transport:"Â§ßÁ¶πÂ∂∫"},
        {id:38, name:"Â∞èÈóúÂ±±", height:3249, grade:"B", range:"Âçó‰∏ÄÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëó§Êûù"},
        {id:39, name:"ÁÑ°ÈõôÂ±±", height:3231, grade:"C", range:"‰∏πÂ§ß", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÁëûÁ©ó"},
        {id:40, name:"ËÉΩÈ´ò‰∏ªÂ≥∞", height:3262, grade:"B", range:"ËÉΩÈ´ò", hut:"Â§©Ê±†Â±±Ëéä", permit:"ÂÖ•Â±±", transport:"Âª¨Â±±"},
        {id:41, name:"ËÉΩÈ´òÂ±±ÂçóÂ≥∞", height:3349, grade:"B", range:"ËÉΩÈ´ò", hut:"Â§©Ê±†Â±±Ëéä", permit:"ÂÖ•Â±±", transport:"Âª¨Â±±"},
        {id:42, name:"ÂÖâÈ†≠Â±±", height:3135, grade:"B", range:"ËÉΩÈ´ò", hut:"Â§©Ê±†Â±±Ëéä", permit:"ÂÖ•Â±±", transport:"Âª¨Â±±"},
        {id:43, name:"ÁôΩÁü≥Â±±", height:3110, grade:"B", range:"ËÉΩÈ´ò", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Âª¨Â±±"},
        {id:44, name:"ÂÆâÊù±ËªçÂ±±", height:3068, grade:"B", range:"ËÉΩÈ´ò", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Âª¨Â±±"},
        {id:45, name:"ÂçìÁ§æÂ§ßÂ±±", height:3369, grade:"C", range:"Âπ≤ÂçìËê¨", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëê¨Â§ß"},
        {id:46, name:"Âπ≤ÂçìËê¨Â±±", height:3284, grade:"C", range:"Âπ≤ÂçìËê¨", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëê¨Â§ß"},
        {id:47, name:"ÁâßÂ±±", height:3241, grade:"C", range:"Âπ≤ÂçìËê¨", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëê¨Â§ß"},
        {id:48, name:"ÁÅ´Â±±", height:3258, grade:"C", range:"Âπ≤ÂçìËê¨", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëê¨Â§ß"},
        {id:49, name:"Ê°ÉÂ±±", height:3325, grade:"A", range:"Ê≠¶ÈôµÂõõÁßÄ", hut:"Ê°ÉÂ±±Â±±Â±ã", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:50, name:"ÂñÄÊãâÊ•≠Â±±", height:3133, grade:"A", range:"Ê≠¶ÈôµÂõõÁßÄ", hut:"Ê°ÉÂ±±Â±±Â±ã", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:51, name:"Ê±†ÊúâÂ±±", height:3303, grade:"A", range:"Ê≠¶ÈôµÂõõÁßÄ", hut:"Êñ∞ÈÅîÂ±±Â±ã", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:52, name:"ÂÖ´ÈÄöÈóúÂ±±", height:3335, grade:"A", range:"Âçó‰∫åÊÆµ", hut:"ËßÄÈ´òÂù™", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:53, name:"Êµ∑Ë´æÂçóÂ±±", height:3175, grade:"B", range:"Âçó‰∏ÄÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëó§Êûù"},
        {id:54, name:"ÈóúÂ±±Â∂∫Â±±", height:3176, grade:"A", range:"ÂçóÊ©´", hut:"ÁÑ°", permit:"ÂÖç", transport:"Â§ßÈóúÂ±±"},
        {id:55, name:"Â°îÈóúÂ±±", height:3222, grade:"A", range:"ÂçóÊ©´", hut:"ÁÑ°", permit:"ÂÖç", transport:"ÂçóÊ©´"},
        {id:56, name:"Â∫´ÂìàË´æÊñØÂ±±", height:3115, grade:"A", range:"ÂçóÊ©´", hut:"Â∫´ÂìàË´æÊñØÂ±±Â±ã", permit:"ÂÖ•Âúí", transport:"ÂçóÊ©´"},
        {id:57, name:"Èõ≤Â≥∞", height:3564, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:58, name:"Â∏ïÊâòÈ≠ØÂ±±", height:3101, grade:"C", range:"Â•áËêäÊù±Á®ú", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"ÂêàÊ≠°"},
        {id:59, name:"Á´ãÈúß‰∏ªÂ±±", height:3070, grade:"C", range:"Â•áËêäÊù±Á®ú", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"ÂêàÊ≠°"},
        {id:60, name:"Á£êÁü≥Â±±", height:3106, grade:"C", range:"Â•áËêäÊù±Á®ú", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"ÂêàÊ≠°"},
        {id:61, name:"ÁîòËñØÂ≥∞", height:3158, grade:"C", range:"Âåó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"Ê∏ÖÊ≥âÊ©ã"},
        {id:62, name:"ÁÑ°ÊòéÂ±±", height:3451, grade:"C", range:"Âåó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"Ê∏ÖÊ≥âÊ©ã"},
        {id:63, name:"Èà¥È≥¥Â±±", height:3272, grade:"B", range:"Âåó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"Ê∏ÖÊ≥âÊ©ã"},
        {id:64, name:"Áï¢Á•øÂ±±", height:3371, grade:"B", range:"Âåó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖç", transport:"Â§ßÁ¶πÂ∂∫"},
        {id:65, name:"ÁæäÈ†≠Â±±", height:3035, grade:"B", range:"Âåó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖç", transport:"ÊÖàÊÅ©"},
        {id:66, name:"ÂÖ≠È†ÜÂ±±", height:2999, grade:"C", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëê¨Ê¶Æ"},
        {id:67, name:"Â§ßÂäçÂ±±", height:3594, grade:"C", range:"Èõ™Â±±", hut:"Ê≤πÂ©ÜËò≠", permit:"ÂÖ•Âúí", transport:"Ê¢®Â±±"},
        {id:68, name:"ÂäçÂ±±", height:3253, grade:"C", range:"Èõ™Â±±", hut:"Ê≤πÂ©ÜËò≠", permit:"ÂÖ•Âúí", transport:"Ê¢®Â±±"},
        {id:69, name:"‰Ω≥ÈôΩÂ±±", height:3314, grade:"C", range:"Èõ™Â±±", hut:"Ê≤πÂ©ÜËò≠", permit:"ÂÖ•Âúí", transport:"Ê¢®Â±±"},
        {id:70, name:"ÈπøÂ±±", height:2981, grade:"C", range:"ÁéâÂ±±", hut:"ÂúìÂ≥∞Â±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©"},
        {id:71, name:"Êù±Â∞èÂçóÂ±±", height:3711, grade:"B", range:"ÁéâÂ±±", hut:"ÂúìÂ≥∞Â±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©"},
        {id:72, name:"ÁéâÂ±±ÂçóÂ≥∞", height:3844, grade:"B", range:"ÁéâÂ±±", hut:"ÂúìÂ≥∞Â±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©"},
        {id:73, name:"ÂçóÁéâÂ±±", height:3383, grade:"B", range:"ÁéâÂ±±", hut:"ÂúìÂ≥∞Â±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©"},
        {id:74, name:"ÁéâÂ±±ÂåóÂ≥∞", height:3858, grade:"B", range:"ÁéâÂ±±", hut:"ÊéíÈõ≤Â±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©"},
        {id:75, name:"ÁéâÂ±±Ë•øÂ≥∞", height:3517, grade:"B", range:"ÁéâÂ±±", hut:"ÊéíÈõ≤Â±±Â±ã", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"ÂòâÁæ©"},
        {id:76, name:"‰∏âÂèâÂ±±", height:3496, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"ÂòâÊòéÊπñÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÂêëÈôΩ"},
        {id:77, name:"ÂçóÈõôÈ†≠Â±±", height:3356, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:78, name:"ËΩÜËΩÜÂ±±", height:3279, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"ËΩÜËΩÜË∞∑", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:79, name:"Â°îËä¨Â±±", height:3070, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"Â°îËä¨Ê±†", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:80, name:"ÈÅîËä¨Â∞ñÂ±±", height:3208, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:81, name:"Â∑¥Â∑¥Â±±", height:3442, grade:"B", range:"ÂçóÊπñ", hut:"ÂçóÊπñÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÊÄùÊ∫ê"},
        {id:82, name:"È¶¨ÊØîÊùâÂ±±", height:3211, grade:"C", range:"ÂçóÊπñ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÊÄùÊ∫ê"},
        {id:83, name:"ÂçóÊπñÂçóÂ≥∞", height:3462, grade:"B", range:"ÂçóÊπñ", hut:"ÂçóÊπñÂ±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÊÄùÊ∫ê"},
        {id:84, name:"ÂØ©È¶¨Èô£Â±±", height:3141, grade:"A", range:"ÂçóÊπñ", hut:"ÂØ©È¶¨Èô£Â±±Â±ã", permit:"ÂÖ•Â±±", transport:"ÊÄùÊ∫ê"},
        {id:85, name:"Èõ™Â±±Êù±Â≥∞", height:3201, grade:"A", range:"Èõ™Â±±", hut:"‰∏ÉÂç°Â±±Ëéä", permit:"ÂÖ•Âúí", transport:"Ê≠¶Èôµ"},
        {id:86, name:"ÈñÇÂ±±", height:3168, grade:"A", range:"Âåó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí", transport:"Ê∏ÖÊ≥âÊ©ã"},
        {id:87, name:"Ë•øÂ∑íÂ§ßÂ±±", height:3081, grade:"B", range:"ÁéâÂ±±Ë•øÈÉ®", hut:"ÁÑ°", permit:"ÂÖç", transport:"‰∫∫ÂÄ´"},
        {id:88, name:"ÈÉ°Â§ßÂ±±", height:3265, grade:"A", range:"ÁéâÂ±±Ë•øÈÉ®", hut:"ÁÑ°", permit:"ÂÖç", transport:"ÈÉ°Â§ßÊûóÈÅì"},
        {id:89, name:"Â∏ÉÊãâÂÖãÊ°ëÂ±±", height:3025, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÂêëÈôΩ"},
        {id:90, name:"ÁôΩÂßëÂ§ßÂ±±", height:3341, grade:"B", range:"‰∏≠Ê©´", hut:"ÁÑ°", permit:"ÂÖç", transport:"Á¥ÖÈ¶ô"},
        {id:91, name:"Âç°ÁæÖÊ®ìÂ±±", height:3385, grade:"C", range:"Â•áËêä", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÂêàÊ≠°"},
        {id:92, name:"‰πùËèØÂ±±", height:3060, grade:"C", range:"‰∏πÂ§ß", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÁëûÁ©ó"},
        {id:93, name:"ÂçóÈõôÈ†≠Â±±", height:3356, grade:"B", range:"Âçó‰∫åÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Âúí+ÂÖ•Â±±", transport:"Êù±Âüî"},
        {id:94, name:"Áæ©Ë•øË´ãÈ¶¨Ëá≥Â±±", height:3245, grade:"C", range:"‰∏≠Â§ÆÂ±±ËÑà", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"ÁëûÁ©ó"},
        {id:95, name:"Â∞èÈóúÂ±±", height:3249, grade:"B", range:"Âçó‰∏ÄÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëó§Êûù"},
        {id:96, name:"Êµ∑Ë´æÂçóÂ±±", height:3175, grade:"B", range:"Âçó‰∏ÄÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëó§Êûù"},
        {id:97, name:"ÈóúÂ±±", height:3668, grade:"B", range:"Âçó‰∏ÄÊÆµ", hut:"Â∫´ÂìàË´æÊñØ", permit:"ÂÖ•Âúí", transport:"ÂçóÊ©´"},
        {id:98, name:"Â∫´ÂìàË´æÊñØÂ±±", height:3115, grade:"A", range:"ÂçóÊ©´", hut:"Â∫´ÂìàË´æÊñØ", permit:"ÂÖ•Âúí", transport:"ÂçóÊ©´"},
        {id:99, name:"ÂçëÂçó‰∏ªÂ±±", height:3295, grade:"C", range:"Âçó‰∏ÄÊÆµ", hut:"ÁÑ°", permit:"ÂÖ•Â±±", transport:"Ëó§Êûù"},
        {id:100, name:"Áü≥ÈñÄÂ±±", height:3237, grade:"A", range:"ÂêàÊ≠°", hut:"ÁÑ°", permit:"ÂÖç", transport:"Âè∞14Áî≤"}
    ];

    let state = {
        completed: JSON.parse(localStorage.getItem('mh-completed')) || {},
        gears: JSON.parse(localStorage.getItem('mh-gears')) || [],
        logs: JSON.parse(localStorage.getItem('mh-train-logs')) || []
    };

    function save() {
        localStorage.setItem('mh-completed', JSON.stringify(state.completed));
        localStorage.setItem('mh-gears', JSON.stringify(state.gears));
        localStorage.setItem('mh-train-logs', JSON.stringify(state.logs));
        updateUI();
    }

    // ÂÇô‰ªΩÈÇèËºØ
    function exportData() {
        const data = JSON.stringify(state, null, 2);
        const blob = new Blob([data], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `MountainHub_Backup_${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
    }

    function importData(event) {
        const file = event.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const imported = JSON.parse(e.target.result);
                state = imported;
                save();
                location.reload();
            } catch (err) {
                alert("ÁÑ°ÊïàÁöÑ JSON Ê™îÊ°à");
            }
        };
        reader.readAsText(file);
    }

    // Â∞éËà™
    function navTo(page) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(`page-${page}`).classList.add('active');
        const navIdx = {home:0, peaks:1, gear:2, training:3}[page];
        document.querySelectorAll('.nav-item')[navIdx].classList.add('active');
    }

    // ÁôæÂ≤≥Ê∏≤Êüì (ÊîØÊè¥ÊêúÂ∞ã)
    function renderPeaks() {
        const query = document.getElementById('peak-search').value.toLowerCase();
        const container = document.getElementById('peaks-container');
        const filtered = PEAKS_DATA.filter(p => p.name.includes(query) || p.range.includes(query) || p.grade.toLowerCase().includes(query));

        container.innerHTML = filtered.map(p => `
            <div class="peak-item" onclick="togglePeak(${p.id})">
                <div class="peak-main">
                    <span class="peak-title">${p.id.toString().padStart(3, '0')} ${p.name} (${p.height}m) ${state.completed[p.id] ? '‚úì' : ''}</span>
                    <span class="peak-meta">${p.grade}Á¥ö | ${p.range}</span>
                </div>
                <div id="peak-detail-${p.id}" class="peak-details">
                    <p>üõñ Â±±Â±ãÔºö${p.hut}</p>
                    <p>üìã Ë≠â‰ª∂Ôºö${p.permit}</p>
                    <p>üöå ‰∫§ÈÄöÔºö${p.transport}</p>
                    <button class="btn-done ${state.completed[p.id] ? 'is-completed' : ''}" onclick="toggleComplete(event, ${p.id})">
                        ${state.completed[p.id] ? 'Â∑≤ÂÆåÁôª (' + state.completed[p.id] + ')' : 'Ê®ôË®òÁÇ∫ÂÆåÁôª'}
                    </button>
                </div>
            </div>
        `).join('');
    }

    function togglePeak(id) {
        const el = document.getElementById(`peak-detail-${id}`);
        const isOpen = el.classList.contains('open');
        document.querySelectorAll('.peak-details').forEach(d => d.classList.remove('open'));
        if(!isOpen) el.classList.add('open');
    }

    function toggleComplete(event, id) {
        event.stopPropagation();
        if (state.completed[id]) delete state.completed[id];
        else state.completed[id] = new Date().toISOString().split('T')[0];
        save();
        renderPeaks();
    }

    // Ë£ùÂÇôÊ∏≤Êüì (Á≥ªÁµ±ÂàÜÈ°û)
    function addGear() {
        const category = document.getElementById('gear-category').value;
        const name = document.getElementById('gear-name').value;
        const weight = parseInt(document.getElementById('gear-weight').value);
        if(!name || isNaN(weight)) return;
        state.gears.push({ id: Date.now(), category, name, weight });
        document.getElementById('gear-name').value = '';
        document.getElementById('gear-weight').value = '';
        save();
        renderGears();
    }

    function deleteGear(id) {
        state.gears = state.gears.filter(g => g.id !== id);
        save();
        renderGears();
    }

    function renderGears() {
        const container = document.getElementById('gear-container');
        const categories = ["ÁÇäÂÖ∑Á≥ªÁµ±", "ÈõªÂ≠êÁ≥ªÁµ±", "ËÉåË≤†Á≥ªÁµ±", "Áù°Áú†Á≥ªÁµ±", "ÂÖ∂‰ªñ"];
        let html = '';
        categories.forEach(cat => {
            const items = state.gears.filter(g => g.category === cat || (!g.category && cat === "ÂÖ∂‰ªñ"));
            if(items.length > 0) {
                html += `<h2>${cat}</h2>`;
                items.forEach(g => {
                    html += `
                        <div class="list-row">
                            <div style="display:flex; align-items:center;">
                                <input type="checkbox" onchange="calcWeight()" class="gear-checkbox" data-weight="${g.weight}" style="margin-right:12px; width:18px; height:18px;">
                                ${g.name}
                            </div>
                            <div>${g.weight}g <span onclick="deleteGear(${g.id})" style="margin-left:15px; color:#ccc; cursor:pointer;">√ó</span></div>
                        </div>
                    `;
                });
            }
        });
        container.innerHTML = html || "<p style='color:#717171; font-size:13px; margin-top:20px;'>Â∞öÊú™Êñ∞Â¢ûË£ùÂÇô„ÄÇ</p>";
        calcWeight();
    }

    function calcWeight() {
        let totalMg = 0;
        document.querySelectorAll('.gear-checkbox:checked').forEach(cb => { totalMg += parseInt(cb.dataset.weight); });
        document.getElementById('base-weight-display').innerText = (totalMg / 1000).toFixed(2);
    }

    // Ë®ìÁ∑¥Êó•Ë™å
    function addTrain() {
        const date = document.getElementById('train-date').value;
        const desc = document.getElementById('train-desc').value;
        if(!date || !desc) return;
        state.logs.push({ id: Date.now(), date, desc });
        document.getElementById('train-desc').value = '';
        save();
        renderLogs();
    }

    function deleteLog(id) {
        state.logs = state.logs.filter(l => l.id !== id);
        save();
        renderLogs();
    }

    function renderLogs() {
        const container = document.getElementById('training-container');
        const sortedLogs = [...state.logs].sort((a, b) => b.date.localeCompare(a.date));
        container.innerHTML = sortedLogs.map(l => `
            <div class="list-row">
                <div style="flex:1;">
                    <div class="log-date">${l.date}</div>
                    <div style="font-size:14px; color:#333;">${l.desc}</div>
                </div>
                <span onclick="deleteLog(${l.id})" style="color:#ccc; font-size:22px; cursor:pointer;">√ó</span>
            </div>
        `).join('');
    }

    function updateUI() {
        const count = Object.keys(state.completed).length;
        document.getElementById('total-done-count').innerText = count;
        document.getElementById('main-progress-bar').style.width = count + '%';
    }

    function showCompletedList() {
        const content = document.getElementById('completed-list-content');
        const entries = Object.entries(state.completed).sort((a,b) => b[1].localeCompare(a[1]));
        content.innerHTML = entries.length === 0 ? "<p style='text-align:center; padding:40px;'>ÁÑ°Á¥ÄÈåÑ</p>" :
            entries.map(([id, date]) => {
                const p = PEAKS_DATA.find(x => x.id == id);
                return `<div class="list-row"><strong>${p ? p.name : 'Êú™Áü•'}</strong> <span>${date}</span></div>`;
            }).join('');
        document.getElementById('modal-completed').classList.add('active');
    }

    function closeModal() {
        document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
    }

    window.onload = () => {
        document.getElementById('train-date').valueAsDate = new Date();
        renderPeaks();
        renderGears();
        renderLogs();
        updateUI();
    };
</script>

</body>
</html>

